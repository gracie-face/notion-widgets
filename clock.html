<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>World Clock — Retro Split-Flap (Unified Pill, C1)</title>
<style>
  :root{
    /* Brand palette E */
    --seed:#CAD23C;      /* pill background */
    --grassy:#47510B;    /* text */
    --flap-bg:#2C3107;   /* split-flap tile bg */
    --flap-fg:#E6F0A2;   /* split-flap digit color */
    --shadow:0 10px 24px rgba(0,0,0,.14), 0 2px 6px rgba(0,0,0,.10);
  }

  *{box-sizing:border-box}
  body{
    margin:0; padding:22px;
    background:#f5f5f5; color:var(--grassy);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
  }

  /* ===== Unified pill ===== */
  .mega{
    width:100%;
    background:var(--seed);
    border-radius:64px;
    box-shadow:var(--shadow);
    padding:20px clamp(14px, 2.4vw, 28px);
  }

  /* Zones inside the pill – responsive grid */
  .zones{
    display:grid;
    grid-template-columns: repeat(3, 1fr);
    gap: clamp(10px, 1.8vw, 22px);
    position:relative;
  }

  /* C1: thin vertical divider lines between zones (hidden on narrow stacks) */
  @media (min-width: 860px){
    .zone{ position:relative; }
    .zone:not(:last-child)::after{
      content:"";
      position:absolute; top:4%; bottom:4%; right:-clamp(5px, .9vw, 10px);
      width:2px; background:rgba(71,81,11,.18); border-radius:2px;
    }
  }

  /* Break to 2 columns on medium screens */
  @media (max-width: 1020px){
    .zones{ grid-template-columns: repeat(2, 1fr); }
  }
  /* Stack vertically on small screens / narrow Notion embeds */
  @media (max-width: 680px){
    .zones{ grid-template-columns: 1fr; }
  }

  .zone{
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    padding: clamp(6px, 1.2vw, 10px) clamp(6px, 1.6vw, 12px);
    text-align:center;
  }

  .label{
    font-weight:900; letter-spacing:1px; text-transform:uppercase;
    font-size: clamp(11px, 1.1vw, 13px);
    margin-bottom: clamp(8px, 1.2vw, 12px);
  }

  /* ===== Split-flap time row ===== */
  .time{
    display:flex; align-items:stretch; justify-content:center;
    gap: clamp(6px, .8vw, 10px);
    padding: 2px 0;
  }

  .tile{
    position:relative;
    width: clamp(58px, 7.2vw, 92px);
    height: clamp(64px, 8.5vw, 100px);
    background: var(--flap-bg);
    color: var(--flap-fg);
    border-radius: 14px;
    display:flex; align-items:center; justify-content:center;
    font-family: "Roboto Mono", SFMono-Regular, Menlo, Consolas, monospace;
    font-weight:800; font-size: clamp(38px, 4.8vw, 62px);
    letter-spacing:1px;
    box-shadow: inset 0 -5px 0 rgba(0,0,0,.25), inset 0 6px 0 rgba(255,255,255,.06);
    overflow:hidden;
    transform-style: preserve-3d;
    perspective: 800px;
  }
  .tile:before, .tile:after{
    content:""; position:absolute; left:0; right:0; height:1px; background:rgba(255,255,255,.12);
  }
  .tile:before{ top:50%; opacity:.25 }
  .tile:after{ top:calc(50% + 1px); opacity:.08 }

  .colon{
    width: clamp(22px, 2.8vw, 40px);
    background: var(--flap-fg);
    color: var(--flap-bg);
    border-radius: 12px;
    display:flex; align-items:center; justify-content:center;
    font-family: "Roboto Mono", SFMono-Regular, Menlo, Consolas, monospace;
    font-weight:900; font-size: clamp(22px, 3vw, 38px);
    box-shadow: inset 0 2px 0 rgba(255,255,255,.35);
  }

  /* Flip animation (minute change) */
  .face{
    position:absolute; inset:0;
    display:flex; align-items:center; justify-content:center;
    backface-visibility:hidden;
  }
  .front{ transform:rotateX(0deg) }
  .back { transform:rotateX(-180deg) }
  .tile.flip .front{ animation: flipFront .45s ease-in forwards; }
  .tile.flip .back { animation: flipBack  .45s ease-out forwards; }
  @keyframes flipFront{ to{ transform:rotateX(180deg) } }
  @keyframes flipBack { to{ transform:rotateX(0deg)   } }

  /* City list */
  .cities{
    margin-top: clamp(8px, 1.2vw, 14px);
    display:flex; flex-direction:column; gap:3px;
  }
  .cities div{
    text-transform:uppercase;
    font-weight:900; letter-spacing:.35px;
    font-size: clamp(11px, 1.2vw, 13px);
  }
</style>
</head>
<body>

<div class="mega">
  <div class="zones" id="zones"></div>
</div>

<script>
/* ===== Data ===== */
const ZONES = [
  {
    label: "PACIFIC TIME",
    tz: "America/Los_Angeles",
    cities: ["HOOD RIVER","BEND","MONTEREY","LOS ANGELES"]
  },
  {
    label: "EASTERN TIME",
    tz: "America/New_York",
    cities: ["BROOKLYN","WISCASSET","VASS"]
  },
  {
    label: "WEST AFRICA TIME",
    tz: "Africa/Lagos",
    cities: ["LAGOS"]
  }
];

/* ===== Helpers ===== */
function hhmm(date, tz){
  // returns "HH:MM" (12h, zero-padded) – drop AM/PM visually
  const s = new Intl.DateTimeFormat(undefined,{
    hour:'2-digit', minute:'2-digit', hour12:true, timeZone:tz
  }).format(date).replace(/\s/g,'');
  return s.slice(0,5);
}

function createTile(d="0"){
  const t = document.createElement('div');
  t.className = 'tile';
  t.innerHTML = `<div class="face front">${d}</div><div class="face back">${d}</div>`;
  return t;
}
function createColon(){
  const c = document.createElement('div');
  c.className = 'colon';
  c.textContent = ':';
  return c;
}

/* ===== Render zones ===== */
const zonesEl = document.getElementById('zones');
const zoneTiles = []; // store tile refs per zone

ZONES.forEach(z=>{
  const zone = document.createElement('section');
  zone.className = 'zone';

  const label = document.createElement('div');
  label.className = 'label';
  label.textContent = z.label;

  const time = document.createElement('div');
  time.className = 'time';
  const t1 = createTile('0');
  const t2 = createTile('0');
  const t3 = createTile('0');
  const t4 = createTile('0');
  time.append(t1,t2,createColon(),t3,t4);

  const cities = document.createElement('div');
  cities.className = 'cities';
  z.cities.forEach(c=>{
    const it = document.createElement('div');
    it.textContent = c;
    cities.appendChild(it);
  });

  zone.append(label,time,cities);
  zonesEl.appendChild(zone);
  zoneTiles.push([t1,t2,t3,t4]);
});

/* ===== Flip logic ===== */
let last = [];

function setFaces(tile, d){
  tile.querySelector('.front').textContent = d;
  tile.querySelector('.back').textContent  = d;
}
function flipTo(tile, d){
  tile.querySelector('.back').textContent = d;
  tile.classList.remove('flip'); void tile.offsetWidth; // restart anim
  tile.classList.add('flip');
  setTimeout(()=>{ setFaces(tile,d); tile.classList.remove('flip'); }, 450);
}

function tick(){
  const now = new Date();
  ZONES.forEach((z, i)=>{
    const s = hhmm(now, z.tz);           // "09:42"
    const digs = [s[0],s[1],s[3],s[4]];  // ["0","9","4","2"]

    if(!last[i]){ // first paint
      digs.forEach((d, j)=> setFaces(zoneTiles[i][j], d));
      last[i] = digs.join('');
      return;
    }

    const prev = last[i].split('');
    digs.forEach((d, j)=>{
      if(d !== prev[j]) flipTo(zoneTiles[i][j], d);
    });
    last[i] = digs.join('');
  });
}

tick();
setInterval(tick, 1000); // check per second; flips only on change
</script>
</body>
</html>
