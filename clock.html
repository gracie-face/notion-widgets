<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>World Clock — Retro Split-Flap (Unified Pill, C1 + AM/PM + Date)</title>
<style>
  :root{
    /* Brand palette E */
    --seed:#CAD23C;      /* pill background */
    --grassy:#47510B;    /* text */
    --flap-bg:#2C3107;   /* split-flap tile bg */
    --flap-fg:#E6F0A2;   /* split-flap digit color */
    --shadow:0 10px 24px rgba(0,0,0,.14), 0 2px 6px rgba(0,0,0,.10);

    /* layout sizing */
    --g: clamp(10px, 1.4vw, 18px);        /* column gap */
    --inner-pad: clamp(14px, 2.2vw, 28px);
    --tile-w: clamp(52px, 6.2vw, 78px);
    --tile-h: clamp(58px, 7.2vw, 88px);
    --tile-font: clamp(34px, 4vw, 54px);
  }

  *{box-sizing:border-box}
  body{
    margin:0; padding:22px;
    background:#f5f5f5; color:var(--grassy);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
  }

  /* ===== Unified pill ===== */
  .mega{
    width:100%;
    background:var(--seed);
    border-radius:64px;
    box-shadow:var(--shadow);
    padding:22px var(--inner-pad);
    overflow:hidden; /* keep everything inside rounded pill */
  }

  /* Zones grid */
  .zones{
    display:grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--g);
    position:relative;
    align-items:center;
  }
  /* C1 dividers – exactly in the gap */
  @media (min-width: 860px){
    .zone{ position:relative; }
    .zone:not(:last-child)::after{
      content:"";
      position:absolute; top:6%; bottom:6%;
      right: calc(var(--g) / -2);
      width:2px; background:rgba(71,81,11,.18); border-radius:2px;
      pointer-events:none;
    }
  }
  @media (max-width: 1020px){
    .zones{ grid-template-columns: repeat(2, 1fr); }
  }
  @media (max-width: 680px){
    .zones{ grid-template-columns: 1fr; }
  }

  .zone{
    display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
    padding: clamp(6px, 1.2vw, 10px) clamp(6px, 1.6vw, 12px);
    text-align:center;
    min-width:0;
  }

  .label{
    font-weight:900; letter-spacing:1px; text-transform:uppercase;
    font-size: clamp(11px, 1.1vw, 13px);
    margin-bottom: clamp(8px, 1.0vw, 10px);
  }

  /* ===== CLOCK ROW (aligned across zones) ===== */
  .row{
    /* fixed band so every zone's numbers share same baseline */
    min-height: calc(var(--tile-h) + 6px);
    display:flex; align-items:center; justify-content:center;
    gap: clamp(4px, .8vw, 8px);
    padding: 2px 0;
    width:100%;
    min-width:0;
  }
  .time{ display:flex; align-items:stretch; justify-content:center; gap: clamp(4px, .8vw, 8px); }

  .ampm{
    margin-left: clamp(8px, 1.1vw, 12px);
    font-weight:900; letter-spacing:.5px;
    font-size: clamp(12px, 1.4vw, 16px);
    text-transform:uppercase;
    color: rgba(71,81,11,.95);
    white-space:nowrap;
  }

  .tile{
    position:relative;
    width: var(--tile-w);
    height: var(--tile-h);
    background: var(--flap-bg);
    color: var(--flap-fg);
    border-radius: 14px;
    display:flex; align-items:center; justify-content:center;
    font-family: "Roboto Mono", SFMono-Regular, Menlo, Consolas, monospace;
    font-weight:800; font-size: var(--tile-font);
    letter-spacing:1px;
    box-shadow: inset 0 -5px 0 rgba(0,0,0,.25), inset 0 6px 0 rgba(255,255,255,.06);
    overflow:hidden;
    transform-style: preserve-3d;
    perspective: 800px;
  }
  .tile:before, .tile:after{
    content:""; position:absolute; left:0; right:0; height:1px; background:rgba(255,255,255,.12);
  }
  .tile:before{ top:50%; opacity:.25 }
  .tile:after{ top:calc(50% + 1px); opacity:.08 }

  .colon{
    width: clamp(18px, 2.2vw, 30px);
    background: var(--flap-fg);
    color: var(--flap-bg);
    border-radius: 12px;
    display:flex; align-items:center; justify-content:center;
    font-family: "Roboto Mono", SFMono-Regular, Menlo, Consolas, monospace;
    font-weight:900; font-size: clamp(20px, 2.6vw, 34px);
    box-shadow: inset 0 2px 0 rgba(255,255,255,.35);
  }

  /* Flip animation (minute change) */
  .face{
    position:absolute; inset:0;
    display:flex; align-items:center; justify-content:center;
    backface-visibility:hidden;
  }
  .front{ transform:rotateX(0deg) }
  .back { transform:rotateX(-180deg) }
  .tile.flip .front{ animation: flipFront .45s ease-in forwards; }
  .tile.flip .back { animation: flipBack  .45s ease-out forwards; }
  @keyframes flipFront{ to{ transform:rotateX(180deg) } }
  @keyframes flipBack { to{ transform:rotateX(0deg)   } }

  /* Date */
  .date{
    margin-top: clamp(6px, .9vw, 10px);
    font-weight:900; letter-spacing:.4px;
    font-size: clamp(11px, 1.2vw, 13px);
    min-height: 1.4em;  /* reserve space so rows stay aligned */
  }

  /* City list – compact; fixed band height to avoid pushing clocks */
  .cities{
    margin-top: clamp(6px, .9vw, 10px);
    display:flex; flex-direction:column; gap:2px;
    min-height: 4.2em; /* equalize height across zones */
  }
  .cities div{
    text-transform:uppercase;
    font-weight:900; letter-spacing:.3px;
    font-size: clamp(10px, 1.05vw, 12px);
  }
</style>
</head>
<body>

<div class="mega">
  <div class="zones" id="zones"></div>
</div>

<script>
/* ===== Data ===== */
const ZONES = [
  {
    label: "PACIFIC TIME",
    tz: "America/Los_Angeles",
    cities: ["HOOD RIVER","BEND","MONTEREY","LOS ANGELES"]
  },
  {
    label: "EASTERN TIME",
    tz: "America/New_York",
    cities: ["BROOKLYN","WISCASSET","VASS"]
  },
  {
    label: "WEST AFRICA TIME",
    tz: "Africa/Lagos",
    cities: ["LAGOS"]
  }
];

/* ===== Helpers ===== */
function timeParts(date, tz){
  // 12-hour with AM/PM, returns { h1,h2,m1,m2,ampm }
  const f = new Intl.DateTimeFormat(undefined,{
    hour:'2-digit', minute:'2-digit', hour12:true, timeZone:tz
  }).format(date).replace(/\s/g,''); // "09:42AM"
  return { h1:f[0], h2:f[1], m1:f[3], m2:f[4], ampm: f.slice(5).toUpperCase() };
}
function shortDate(date, tz){
  const fmt = new Intl.DateTimeFormat(undefined,{
    weekday:'short', month:'short', day:'numeric', timeZone:tz
  }).format(date); // "Tue, Feb 11"
  return fmt;
}

function createTile(d="0"){
  const t = document.createElement('div');
  t.className = 'tile';
  t.innerHTML = `<div class="face front">${d}</div><div class="face back">${d}</div>`;
  return t;
}
function createColon(){
  const c = document.createElement('div');
  c.className = 'colon';
  c.textContent = ':';
  return c;
}

/* ===== Render zones ===== */
const zonesEl = document.getElementById('zones');
const zoneRefs = []; // {tiles:[t1,t2,t3,t4], ampmEl, dateEl}

ZONES.forEach(z=>{
  const zone = document.createElement('section');
  zone.className = 'zone';

  const label = document.createElement('div');
  label.className = 'label';
  label.textContent = z.label;

  const row = document.createElement('div');
  row.className = 'row';

  const time = document.createElement('div');
  time.className = 'time';
  const t1 = createTile('0');
  const t2 = createTile('0');
  const t3 = createTile('0');
  const t4 = createTile('0');
  time.append(t1,t2,createColon(),t3,t4);

  const ampm = document.createElement('div');
  ampm.className = 'ampm';
  ampm.textContent = 'AM';

  row.append(time, ampm);

  const date = document.createElement('div');
  date.className = 'date';
  date.textContent = '';

  const cities = document.createElement('div');
  cities.className = 'cities';
  z.cities.forEach(c=>{
    const it = document.createElement('div');
    it.textContent = c;
    cities.appendChild(it);
  });

  zone.append(label,row,date,cities);
  zonesEl.appendChild(zone);
  zoneRefs.push({tiles:[t1,t2,t3,t4], ampmEl: ampm, dateEl: date, tz: z.tz});
});

/* ===== Flip logic ===== */
let lastDigits = []; // per zone "h1h2m1m2"
let lastDate   = []; // per zone date string

function setFaces(tile, d){
  tile.querySelector('.front').textContent = d;
  tile.querySelector('.back').textContent  = d;
}
function flipTo(tile, d){
  tile.querySelector('.back').textContent = d;
  tile.classList.remove('flip'); void tile.offsetWidth; // restart anim
  tile.classList.add('flip');
  setTimeout(()=>{ setFaces(tile,d); tile.classList.remove('flip'); }, 450);
}

function tick(){
  const now = new Date();
  zoneRefs.forEach((ref, i)=>{
    const p = timeParts(now, ref.tz);
    const digs = [p.h1,p.h2,p.m1,p.m2];

    // first paint
    if(!lastDigits[i]){
      digs.forEach((d, j)=> setFaces(ref.tiles[j], d));
      lastDigits[i] = digs.join('');
    }else{
      const prev = lastDigits[i].split('');
      digs.forEach((d, j)=>{
        if(d !== prev[j]) flipTo(ref.tiles[j], d);
      });
      lastDigits[i] = digs.join('');
    }

    // AM/PM
    ref.ampmEl.textContent = p.ampm;

    // Date (short)
    const dstr = shortDate(now, ref.tz);
    if(dstr !== lastDate[i]){
      ref.dateEl.textContent = dstr;
      lastDate[i] = dstr;
    }
  });
}

tick();
setInterval(tick, 1000); // check per second; flips only when digits change
</script>
</body>
</html>
